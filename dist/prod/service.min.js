!function webpackUniversalModuleDefinition(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var s in r)("object"==typeof exports?exports:e)[s]=r[s]}}(window,(function(){return function(e){var t={};function __webpack_require__(r){if(t[r])return t[r].exports;var s=t[r]={i:r,l:!1,exports:{}};return e[r].call(s.exports,s,s.exports,__webpack_require__),s.l=!0,s.exports}return __webpack_require__.m=e,__webpack_require__.c=t,__webpack_require__.d=function(e,t,r){__webpack_require__.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},__webpack_require__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.t=function(e,t){if(1&t&&(e=__webpack_require__(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(__webpack_require__.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)__webpack_require__.d(r,s,function(t){return e[t]}.bind(null,s));return r},__webpack_require__.n=function(e){var t=e&&e.__esModule?function getDefault(){return e.default}:function getModuleExports(){return e};return __webpack_require__.d(t,"a",t),t},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=1)}([function(e,t,r){!function webpackUniversalModuleDefinition(t,r){e.exports=r()}(window,(function(){return function(e){var t={};function __webpack_require__(r){if(t[r])return t[r].exports;var s=t[r]={i:r,l:!1,exports:{}};return e[r].call(s.exports,s,s.exports,__webpack_require__),s.l=!0,s.exports}return __webpack_require__.m=e,__webpack_require__.c=t,__webpack_require__.d=function(e,t,r){__webpack_require__.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},__webpack_require__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.t=function(e,t){if(1&t&&(e=__webpack_require__(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(__webpack_require__.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)__webpack_require__.d(r,s,function(t){return e[t]}.bind(null,s));return r},__webpack_require__.n=function(e){var t=e&&e.__esModule?function getDefault(){return e.default}:function getModuleExports(){return e};return __webpack_require__.d(t,"a",t),t},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s="./index.js")}({"./index.js":function(e,t,r){"use strict";r.r(t);var s=r("./src/core/messaging-service.js");r.d(t,"MessagingService",(function(){return s.default}));var i=r("./src/destinations/window-iframe-destination.js");r.d(t,"WindowIframeDestination",(function(){return i.default}));var n=r("./src/messages/request-message.js");r.d(t,"RequestMessage",(function(){return n.default}));var o=r("./src/messages/response-message.js");r.d(t,"ResponseMessage",(function(){return o.default}));var a=r("./src/configurations/destinations.js");r.d(t,"CedictDestinationConfig",(function(){return a.CedictDestinationConfig})),r.d(t,"CedictDestinationDevConfig",(function(){return a.CedictDestinationDevConfig}))},"./node_modules/uuid/dist/esm-browser/bytesToUuid.js":function(e,t,r){"use strict";r.r(t);for(var s=[],i=0;i<256;++i)s[i]=(i+256).toString(16).substr(1);t.default=function bytesToUuid(e,t){var r=t||0,i=s;return[i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]]].join("")}},"./node_modules/uuid/dist/esm-browser/index.js":function(e,t,r){"use strict";r.r(t);var s=r("./node_modules/uuid/dist/esm-browser/v1.js");r.d(t,"v1",(function(){return s.default}));var i=r("./node_modules/uuid/dist/esm-browser/v3.js");r.d(t,"v3",(function(){return i.default}));var n=r("./node_modules/uuid/dist/esm-browser/v4.js");r.d(t,"v4",(function(){return n.default}));var o=r("./node_modules/uuid/dist/esm-browser/v5.js");r.d(t,"v5",(function(){return o.default}))},"./node_modules/uuid/dist/esm-browser/md5.js":function(e,t,r){"use strict";function safeAdd(e,t){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}function md5cmn(e,t,r,s,i,n){return safeAdd(function bitRotateLeft(e,t){return e<<t|e>>>32-t}(safeAdd(safeAdd(t,e),safeAdd(s,n)),i),r)}function md5ff(e,t,r,s,i,n,o){return md5cmn(t&r|~t&s,e,t,i,n,o)}function md5gg(e,t,r,s,i,n,o){return md5cmn(t&s|r&~s,e,t,i,n,o)}function md5hh(e,t,r,s,i,n,o){return md5cmn(t^r^s,e,t,i,n,o)}function md5ii(e,t,r,s,i,n,o){return md5cmn(r^(t|~s),e,t,i,n,o)}r.r(t),t.default=function md5(e){if("string"==typeof e){var t=unescape(encodeURIComponent(e));e=new Array(t.length);for(var r=0;r<t.length;r++)e[r]=t.charCodeAt(r)}return function md5ToHexEncodedArray(e){var t,r,s,i=[],n=32*e.length;for(t=0;t<n;t+=8)r=e[t>>5]>>>t%32&255,s=parseInt("0123456789abcdef".charAt(r>>>4&15)+"0123456789abcdef".charAt(15&r),16),i.push(s);return i}(function wordsToMd5(e,t){var r,s,i,n,o;e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;var a=1732584193,d=-271733879,c=-1732584194,u=271733878;for(r=0;r<e.length;r+=16)s=a,i=d,n=c,o=u,a=md5ff(a,d,c,u,e[r],7,-680876936),u=md5ff(u,a,d,c,e[r+1],12,-389564586),c=md5ff(c,u,a,d,e[r+2],17,606105819),d=md5ff(d,c,u,a,e[r+3],22,-1044525330),a=md5ff(a,d,c,u,e[r+4],7,-176418897),u=md5ff(u,a,d,c,e[r+5],12,1200080426),c=md5ff(c,u,a,d,e[r+6],17,-1473231341),d=md5ff(d,c,u,a,e[r+7],22,-45705983),a=md5ff(a,d,c,u,e[r+8],7,1770035416),u=md5ff(u,a,d,c,e[r+9],12,-1958414417),c=md5ff(c,u,a,d,e[r+10],17,-42063),d=md5ff(d,c,u,a,e[r+11],22,-1990404162),a=md5ff(a,d,c,u,e[r+12],7,1804603682),u=md5ff(u,a,d,c,e[r+13],12,-40341101),c=md5ff(c,u,a,d,e[r+14],17,-1502002290),d=md5ff(d,c,u,a,e[r+15],22,1236535329),a=md5gg(a,d,c,u,e[r+1],5,-165796510),u=md5gg(u,a,d,c,e[r+6],9,-1069501632),c=md5gg(c,u,a,d,e[r+11],14,643717713),d=md5gg(d,c,u,a,e[r],20,-373897302),a=md5gg(a,d,c,u,e[r+5],5,-701558691),u=md5gg(u,a,d,c,e[r+10],9,38016083),c=md5gg(c,u,a,d,e[r+15],14,-660478335),d=md5gg(d,c,u,a,e[r+4],20,-405537848),a=md5gg(a,d,c,u,e[r+9],5,568446438),u=md5gg(u,a,d,c,e[r+14],9,-1019803690),c=md5gg(c,u,a,d,e[r+3],14,-187363961),d=md5gg(d,c,u,a,e[r+8],20,1163531501),a=md5gg(a,d,c,u,e[r+13],5,-1444681467),u=md5gg(u,a,d,c,e[r+2],9,-51403784),c=md5gg(c,u,a,d,e[r+7],14,1735328473),d=md5gg(d,c,u,a,e[r+12],20,-1926607734),a=md5hh(a,d,c,u,e[r+5],4,-378558),u=md5hh(u,a,d,c,e[r+8],11,-2022574463),c=md5hh(c,u,a,d,e[r+11],16,1839030562),d=md5hh(d,c,u,a,e[r+14],23,-35309556),a=md5hh(a,d,c,u,e[r+1],4,-1530992060),u=md5hh(u,a,d,c,e[r+4],11,1272893353),c=md5hh(c,u,a,d,e[r+7],16,-155497632),d=md5hh(d,c,u,a,e[r+10],23,-1094730640),a=md5hh(a,d,c,u,e[r+13],4,681279174),u=md5hh(u,a,d,c,e[r],11,-358537222),c=md5hh(c,u,a,d,e[r+3],16,-722521979),d=md5hh(d,c,u,a,e[r+6],23,76029189),a=md5hh(a,d,c,u,e[r+9],4,-640364487),u=md5hh(u,a,d,c,e[r+12],11,-421815835),c=md5hh(c,u,a,d,e[r+15],16,530742520),d=md5hh(d,c,u,a,e[r+2],23,-995338651),a=md5ii(a,d,c,u,e[r],6,-198630844),u=md5ii(u,a,d,c,e[r+7],10,1126891415),c=md5ii(c,u,a,d,e[r+14],15,-1416354905),d=md5ii(d,c,u,a,e[r+5],21,-57434055),a=md5ii(a,d,c,u,e[r+12],6,1700485571),u=md5ii(u,a,d,c,e[r+3],10,-1894986606),c=md5ii(c,u,a,d,e[r+10],15,-1051523),d=md5ii(d,c,u,a,e[r+1],21,-2054922799),a=md5ii(a,d,c,u,e[r+8],6,1873313359),u=md5ii(u,a,d,c,e[r+15],10,-30611744),c=md5ii(c,u,a,d,e[r+6],15,-1560198380),d=md5ii(d,c,u,a,e[r+13],21,1309151649),a=md5ii(a,d,c,u,e[r+4],6,-145523070),u=md5ii(u,a,d,c,e[r+11],10,-1120210379),c=md5ii(c,u,a,d,e[r+2],15,718787259),d=md5ii(d,c,u,a,e[r+9],21,-343485551),a=safeAdd(a,s),d=safeAdd(d,i),c=safeAdd(c,n),u=safeAdd(u,o);return[a,d,c,u]}(function bytesToWords(e){var t,r=[];for(r[(e.length>>2)-1]=void 0,t=0;t<r.length;t+=1)r[t]=0;var s=8*e.length;for(t=0;t<s;t+=8)r[t>>5]|=(255&e[t/8])<<t%32;return r}(e),8*e.length))}},"./node_modules/uuid/dist/esm-browser/rng.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return rng}));var s="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),i=new Uint8Array(16);function rng(){if(!s)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return s(i)}},"./node_modules/uuid/dist/esm-browser/sha1.js":function(e,t,r){"use strict";function f(e,t,r,s){switch(e){case 0:return t&r^~t&s;case 1:return t^r^s;case 2:return t&r^t&s^r&s;case 3:return t^r^s}}function ROTL(e,t){return e<<t|e>>>32-t}r.r(t),t.default=function sha1(e){var t=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){var s=unescape(encodeURIComponent(e));e=new Array(s.length);for(var i=0;i<s.length;i++)e[i]=s.charCodeAt(i)}e.push(128);var n=e.length/4+2,o=Math.ceil(n/16),a=new Array(o);for(i=0;i<o;i++){a[i]=new Array(16);for(var d=0;d<16;d++)a[i][d]=e[64*i+4*d]<<24|e[64*i+4*d+1]<<16|e[64*i+4*d+2]<<8|e[64*i+4*d+3]}for(a[o-1][14]=8*(e.length-1)/Math.pow(2,32),a[o-1][14]=Math.floor(a[o-1][14]),a[o-1][15]=8*(e.length-1)&4294967295,i=0;i<o;i++){for(var c=new Array(80),u=0;u<16;u++)c[u]=a[i][u];for(u=16;u<80;u++)c[u]=ROTL(c[u-3]^c[u-8]^c[u-14]^c[u-16],1);var _=r[0],g=r[1],h=r[2],m=r[3],l=r[4];for(u=0;u<80;u++){var p=Math.floor(u/20),w=ROTL(_,5)+f(p,g,h,m)+l+t[p]+c[u]>>>0;l=m,m=h,h=ROTL(g,30)>>>0,g=_,_=w}r[0]=r[0]+_>>>0,r[1]=r[1]+g>>>0,r[2]=r[2]+h>>>0,r[3]=r[3]+m>>>0,r[4]=r[4]+l>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,255&r[0],r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,255&r[1],r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,255&r[2],r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,255&r[3],r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,255&r[4]]}},"./node_modules/uuid/dist/esm-browser/v1.js":function(e,t,r){"use strict";r.r(t);var s,i,n=r("./node_modules/uuid/dist/esm-browser/rng.js"),o=r("./node_modules/uuid/dist/esm-browser/bytesToUuid.js"),a=0,d=0;t.default=function v1(e,t,r){var c=t&&r||0,u=t||[],_=(e=e||{}).node||s,g=void 0!==e.clockseq?e.clockseq:i;if(null==_||null==g){var h=e.random||(e.rng||n.default)();null==_&&(_=s=[1|h[0],h[1],h[2],h[3],h[4],h[5]]),null==g&&(g=i=16383&(h[6]<<8|h[7]))}var m=void 0!==e.msecs?e.msecs:(new Date).getTime(),l=void 0!==e.nsecs?e.nsecs:d+1,p=m-a+(l-d)/1e4;if(p<0&&void 0===e.clockseq&&(g=g+1&16383),(p<0||m>a)&&void 0===e.nsecs&&(l=0),l>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");a=m,d=l,i=g;var w=(1e4*(268435455&(m+=122192928e5))+l)%4294967296;u[c++]=w>>>24&255,u[c++]=w>>>16&255,u[c++]=w>>>8&255,u[c++]=255&w;var E=m/4294967296*1e4&268435455;u[c++]=E>>>8&255,u[c++]=255&E,u[c++]=E>>>24&15|16,u[c++]=E>>>16&255,u[c++]=g>>>8|128,u[c++]=255&g;for(var b=0;b<6;++b)u[c+b]=_[b];return t||Object(o.default)(u)}},"./node_modules/uuid/dist/esm-browser/v3.js":function(e,t,r){"use strict";r.r(t);var s=r("./node_modules/uuid/dist/esm-browser/v35.js"),i=r("./node_modules/uuid/dist/esm-browser/md5.js"),n=Object(s.default)("v3",48,i.default);t.default=n},"./node_modules/uuid/dist/esm-browser/v35.js":function(e,t,r){"use strict";r.r(t),r.d(t,"DNS",(function(){return i})),r.d(t,"URL",(function(){return n}));var s=r("./node_modules/uuid/dist/esm-browser/bytesToUuid.js");var i="6ba7b810-9dad-11d1-80b4-00c04fd430c8",n="6ba7b811-9dad-11d1-80b4-00c04fd430c8";t.default=function(e,t,r){var o=function generateUUID(e,i,n,o){var a=n&&o||0;if("string"==typeof e&&(e=function stringToBytes(e){e=unescape(encodeURIComponent(e));for(var t=new Array(e.length),r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(e)),"string"==typeof i&&(i=function uuidToBytes(e){var t=[];return e.replace(/[a-fA-F0-9]{2}/g,(function(e){t.push(parseInt(e,16))})),t}(i)),!Array.isArray(e))throw TypeError("value must be an array of bytes");if(!Array.isArray(i)||16!==i.length)throw TypeError("namespace must be uuid string or an Array of 16 byte values");var d=r(i.concat(e));if(d[6]=15&d[6]|t,d[8]=63&d[8]|128,n)for(var c=0;c<16;++c)n[a+c]=d[c];return n||Object(s.default)(d)};try{o.name=e}catch(e){}return o.DNS=i,o.URL=n,o}},"./node_modules/uuid/dist/esm-browser/v4.js":function(e,t,r){"use strict";r.r(t);var s=r("./node_modules/uuid/dist/esm-browser/rng.js"),i=r("./node_modules/uuid/dist/esm-browser/bytesToUuid.js");t.default=function v4(e,t,r){var n=t&&r||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var o=(e=e||{}).random||(e.rng||s.default)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var a=0;a<16;++a)t[n+a]=o[a];return t||Object(i.default)(o)}},"./node_modules/uuid/dist/esm-browser/v5.js":function(e,t,r){"use strict";r.r(t);var s=r("./node_modules/uuid/dist/esm-browser/v35.js"),i=r("./node_modules/uuid/dist/esm-browser/sha1.js"),n=Object(s.default)("v5",80,i.default);t.default=n},"./src/configurations/destinations.js":function(e,t,r){"use strict";r.r(t),r.d(t,"CedictDestinationConfig",(function(){return s})),r.d(t,"CedictDestinationDevConfig",(function(){return i}));const s={name:"cedict",targetURL:"https://lexis-dev.alpheios.net",targetIframeID:"alpheios-lexis-cs"},i={name:"cedict",targetURL:"https://lexis-dev.alpheios.net/index-dev.html",targetIframeID:"alpheios-lexis-cs"}},"./src/core/messaging-service.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return MessagingService}));var s=r("./src/messages/message.js"),i=r("./src/messages/response-message.js"),n=r("./src/core/stored-request.js");let o=new Map;class MessagingService{constructor(e,t=[]){if(!e)throw new Error(MessagingService.errMsgs.NO_NAME);this.name=e,this._messages=new Map,this._destinations=new Map,Array.isArray(t)||(t=[t]),t.forEach(e=>this.registerDestination(e))}static hasService(e){return o.has(e)}static getService(e){return o.get(e)}static createService(e,t=[]){const r=new MessagingService(e,t);return o.set(e,r),r}static deleteService(e){return o.delete(e)}registerDestination(e){if(this._destinations.has(e.name))throw new Error("Destination already exists");this._destinations.set(e.name,e),e.ableToSend&&e.registerResponseCallback(this.dispatchMessage.bind(this))}updateDestination(e){if(!this._destinations.has(e.name))throw new Error("Cannot update a destination that does not exist");this._destinations.get(e.name).deregister(),this._destinations.set(e.name,e),e.ableToSend&&e.registerResponseCallback(this.dispatchMessage.bind(this))}dispatchMessage(e){if(!s.default.isKnownType(e.type))return;if(!i.default.isResponse(e))return void console.error("A message not following a response format will be ignored:",e);if(!this._messages.has(e.requestID))return;const t=this._messages.get(e.requestID);window.clearTimeout(t.timeoutID),e.responseCode===i.default.responseCodes.ERROR?t.reject(e):t.resolve(e),this._messages.delete(e.requestID)}registerRequest(e,t=1e4){if(this._messages.has(e.ID))throw new Error(`Request with ${e.ID} ID is already registered`);let r=new n.default(e);return this._messages.set(e.ID,r),r.timeoutID=window.setTimeout(t=>{r.reject(new Error("Timeout has been expired for a message with request ID "+e.ID)),this._messages.delete(t)},t),r.promise}sendRequestTo(e,t,r=1e4){if(!e)throw new Error("Destination name is not provided");if(!this._destinations.has(e))throw new Error("Unknown destination "+e);try{this._destinations.get(e).sendRequest(t)}catch(t){throw new Error(`Request to ${e} failed: ${t.message}`)}return this.registerRequest(t,r)}}MessagingService.errMsgs={NO_NAME:"MessagingService must be created with a name"}},"./src/core/stored-request.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return StoredRequest}));class StoredRequest{constructor(){this.resolve=null,this.reject=null,this.promise=new Promise(this.executor.bind(this))}executor(e,t){this.resolve=e,this.reject=t}}},"./src/destinations/destination.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return Destination}));class Destination{constructor({name:e,commModes:t=[Destination.commModes.SEND]}={}){if(!e)throw new Error("Destination name is missing");this.name=e,this.commModes=t,this._responseCallback=null}get ableToSend(){return this.commModes.includes(Destination.commModes.SEND)}get ableToReceive(){return this.commModes.includes(Destination.commModes.RECEIVE)}deregister(){throw new Error("Deregister method must be defined in a subclass")}}Destination.commModes={SEND:"Send",RECEIVE:"Receive"}},"./src/destinations/window-iframe-destination.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return WindowIframeDestination}));var s=r("./src/messages/message.js"),i=r("./src/destinations/destination.js");class WindowIframeDestination extends i.default{constructor({name:e,targetURL:t,targetIframeID:r,commModes:s,receiverCB:i}={}){if(super({name:e,commModes:s}),!t)throw new Error("Target URL is not provided");if(!r)throw new Error("Target iframe ID is not provided");if(this._targetURL=t,this._targetIframeID=r,this.ableToReceive){if(!i)throw new Error("A receiver callback must be provided for a destination in the RECEIVE communication mode");this._registeredRequestHandler=this._requestHandler.bind(this,i),window.addEventListener("message",this._registeredRequestHandler,!1)}this._registeredRequestHandler=null,this._registeredResponseHandler=null}registerResponseCallback(e){this._registeredResponseHandler=this._responseHandler.bind(this),window.addEventListener("message",this._registeredResponseHandler,!1),this._responseCallback=e}sendRequest(e){const t=document.querySelector("#"+this._targetIframeID);if(!t)throw new Error(`An #${this._targetIframeID} iframe does not exist in the document`);const r=t.contentWindow;let s=!1;try{s="about:blank"===r.location.href}catch(e){if(!(e instanceof DOMException))throw e}if(s)throw new Error(`Target document ${this._targetURL} is not loaded yet`);try{r.postMessage(e,this._targetURL)}catch(t){if(!(t instanceof DOMException&&"DataCloneError"===t.name))throw t;console.warn("Request that does not confirm to the structured clone algorithm cannot be sent, will try to convert it to a plain object and send again"),e.body=WindowIframeDestination._toPostable(e.body),r.postMessage(e,this._targetURL)}}sendResponse(e){try{window.parent.postMessage(e,e.requestHeader.origin)}catch(t){if(!(t instanceof DOMException&&"DataCloneError"===t.name))throw t;console.warn("Response that does not confirm to the structured clone algorithm cannot be sent, will try to convert it to a plain object and send again"),e.body=WindowIframeDestination._toPostable(e.body),window.parent.postMessage(e,e.requestHeader.origin)}}_requestHandler(e,t){if(!WindowIframeDestination._isSupportedEvent(t))return;let r=t.data;r.header.origin=t.origin,e(r,this.sendResponse.bind(this))}_responseHandler(e){if(!WindowIframeDestination._isSupportedEvent(e))return;const t=e.data;this._responseCallback&&this._responseCallback(t)}static _isSupportedEvent(e){return Boolean(e&&e.data&&e.data.type&&s.default.isKnownType(e.data.type))}deregister(){this._registeredResponseHandler&&(window.removeEventListener("message",this._registeredResponseHandler,!1),this._registeredResponseHandler=null),this._registeredRequestHandler||(window.removeEventListener("message",this._registeredRequestHandler,!1),this._registeredRequestHandler=null)}static _toPostable(e){let t;return t=e instanceof Error?{name:e.name,message:e.message}:JSON.parse(JSON.stringify(e)),t}}},"./src/messages/message.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return Message}));var s=r("./node_modules/uuid/dist/esm-browser/index.js");class Message{constructor(e={}){this.role=void 0,this.type=Message.types.GENERIC,this.ID=Object(s.v4)(),this.body=e}static isKnownType(e){return Object.values(Message.types).includes(e)}}Message.roles={REQUEST:"Request",RESPONSE:"Response"},Message.types={GENERIC:"ALPHEIOS_MESSAGE"}},"./src/messages/request-message.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return RequestMessage}));var s=r("./src/messages/message.js");class RequestMessage extends s.default{constructor(e={}){super(e),this.role=s.default.roles.REQUEST,this.header={}}}},"./src/messages/response-message.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return ResponseMessage}));var s=r("./src/messages/message.js");r("./src/messages/request-message.js");class ResponseMessage extends s.default{constructor(e,t={},r=ResponseMessage.responseCodes.UNDEFINED,{errorCode:i}={}){if(super(t),!e)throw new Error("Request is not provided");if(!e.ID)throw new Error("Request has no ID");if(this.role=s.default.roles.RESPONSE,this.requestHeader=e.header||{},this.requestID=e.ID,this.responseCode=r,this.errorCode=0,r===ResponseMessage.responseCodes.ERROR){if(!i)throw new Error("An error code must be provided for failed requests");this.errorCode=i}}static Success(e,t={}){return new this(e,t,ResponseMessage.responseCodes.SUCCESS)}static Error(e,t,r){return new this(e,t,ResponseMessage.responseCodes.ERROR,{errorCode:r})}static isResponse(e){return e.role&&e.role===s.default.roles.RESPONSE&&e.requestHeader&&e.requestID}}ResponseMessage.responseCodes={SUCCESS:"Success",UNDEFINED:"Undefined",ERROR:"Error"},ResponseMessage.errorCodes={SERVICE_UNINITIALIZED:1,INITIALIZATION_ERROR:2,UNKNOWN_REQUEST:3,INTERNAL_ERROR:4}}})}))},function(e,t,r){"use strict";r.r(t),r.d(t,"CedictDestinationConfig",(function(){return s.CedictDestinationConfig})),r.d(t,"CedictCharacterForms",(function(){return i}));var s=r(0);const i={SIMPLIFIED:"simplified",TRADITIONAL:"traditional"};class Storage{constructor(e){this.constructor._checkConfiguration(e),this._configuration=e}static _checkConfiguration(e){if(!e.name)throw new Error(Storage.errMsgs.CONF_NO_NAME);if(!e.version)throw new Error(Storage.errMsgs.CONF_NO_VER)}create(){return new Promise(e=>{e()})}destroy(){return new Promise(e=>{e()})}connect(){return new Promise(e=>{e()})}disconnect(){return new Promise(e=>{e()})}getIntegrityData(){return new Promise(e=>{e({})})}}Storage.errMsgs={CONF_NO_NAME:"Storage name is missing from a configuration",CONF_NO_VER:"Storage version is missing from a configuration"};class Store{constructor(e){this.constructor._checkConfiguration(e),this._configuration=e}static _checkConfiguration(e){if(!e.name)throw new Error(Store.errMsgs.CONF_NO_NAME)}associateWith(e){return this}create(){return new Promise(e=>{e()})}clear(){return new Promise(e=>{e()})}destroy(){return new Promise(e=>{e()})}get(e,t){return new Promise(e=>{e()})}getEntries(e,{index:t=""}={}){return new Promise(e=>{e()})}getAllEntries(){return new Promise(e=>{e()})}insert(e){return new Promise(e=>{e()})}update(e){return new Promise(e=>{e()})}count(){return new Promise(e=>{e()})}}Store.accessModes={READ:"readonly",READ_WRITE:"readwrite"},Store.errMsgs={CONF_NO_NAME:"A store name is missing from a configuration"};class indexed_db_store_IndexedDbStore extends Store{constructor(e){super(e),this._configuration=e,this._db=null}static _checkConfiguration(e){if(!e.name)throw new Error(indexed_db_store_IndexedDbStore.errMsgs.NO_STORE_NAME);if(!e.primaryIndex)throw new Error(indexed_db_store_IndexedDbStore.errMsgs.NO_PRIMARY_INDEX);if(!e.primaryIndex.hasOwnProperty("keyPath")&&!e.primaryIndex.hasOwnProperty("auto"))throw new Error(indexed_db_store_IndexedDbStore.errMsgs.NO_PRIMARY_INDEX_PROPS)}associateWith(e){return this._db=e,this}dissociate(){return this._db=null,this}_assertDb(){if(!this._db)throw new Error(indexed_db_store_IndexedDbStore.errMsgs.NO_DB)}get _isAutoPrimaryKey(){return this._configuration.primaryIndex.hasOwnProperty("auto")&&this._configuration.primaryIndex.auto}get _secondaryIndexes(){return Object.values(this._configuration.indexes)}get _secondaryIndexNames(){return Object.values(this._configuration.indexes).map(e=>e.name)}create(){return new Promise((e,t)=>{this._assertDb();const r=this._configuration.primaryIndex.keyPath?{keyPath:this._configuration.primaryIndex.keyPath}:void 0,s=this._db.createObjectStore(this._configuration.name,r);this._configuration.indexes&&this._secondaryIndexes.forEach(e=>{try{s.createIndex(e.name,e.keyPath,{unique:e.unique})}catch(e){t(e)}}),e()})}clear(){return new Promise((e,t)=>{this._assertDb();let r=this._db.transaction(this._configuration.name,indexed_db_store_IndexedDbStore.accessModes.READ_WRITE);r.onerror=e=>t(e),r.objectStore(this._configuration.name).clear().onsuccess=()=>e()})}async get(e,t={}){if(void 0===e)throw new Error(indexed_db_store_IndexedDbStore.errMsgs.NO_KEYS_PROVIDED);return this.getEntries([e],t).then(t=>t[e])}getEntries(e,{index:t}={}){return new Promise((r,s)=>{this._assertDb(),void 0===e&&s(new Error(indexed_db_store_IndexedDbStore.errMsgs.NO_KEYS_PROVIDED)),Array.isArray(e)||(e=[e]),0===e.length&&s(new Error(indexed_db_store_IndexedDbStore.errMsgs.NO_KEYS_PROVIDED));const i=this._db.transaction(this._configuration.name,indexed_db_store_IndexedDbStore.accessModes.READ).objectStore(this._configuration.name);let n=e.reduce((e,t)=>(e[t]=[],e),{});for(let s=0;s<e.length;s++){const o=e[s];let a;if(void 0===t)a=i.getAll(IDBKeyRange.only(o));else{if(!this._secondaryIndexNames.includes(t))throw new Error(indexed_db_store_IndexedDbStore.errMsgs.MISSING_SECONDARY_INDEX);const e=i.index(t);a=e.getAll(IDBKeyRange.only(o))}a.onsuccess=()=>{n[o]=a.result,s===e.length-1&&r(n)}}})}getAllEntries(){return new Promise((e,t)=>{this._assertDb();const r=this._db.transaction(this._configuration.name,indexed_db_store_IndexedDbStore.accessModes.READ);r.onerror=e=>{t(e)};const s=r.objectStore(this._configuration.name).getAll();s.onsuccess=()=>{const t=s.result;e(t)}})}insert(e){return new Promise((t,r)=>{e||t(),this._assertDb(),Array.isArray(e)||(e=[e]);let s=this._db.transaction(this._configuration.name,indexed_db_store_IndexedDbStore.accessModes.READ_WRITE);s.oncomplete=()=>t(),s.onerror=e=>r(e);const i=s.objectStore(this._configuration.name);e.forEach(e=>{let t=i.add(e);t.onerror=()=>{"ConstraintError"===t.error.name&&r(new Error(indexed_db_store_IndexedDbStore.errMsgs.DUPLICATE_RECORD)),r(t.error)}})})}update(e){return new Promise((t,r)=>{e||t(),Array.isArray(e)||r(new Error("Records format must be [key,val] or [[key,val]]")),Array.isArray(e[0])||(e=[e]),this._assertDb();const s=this._db.transaction(this._configuration.name,indexed_db_store_IndexedDbStore.accessModes.READ_WRITE);s.oncomplete=()=>t(),s.onerror=e=>r(e);const i=s.objectStore(this._configuration.name);e.forEach(e=>{let t=this._isAutoPrimaryKey?i.put(e[0],e[1]):i.put(e[0]);t.onerror=()=>r(t.error)})})}count(){return new Promise((e,t)=>{this._assertDb();try{const t=this._db.transaction(this._configuration.name,indexed_db_store_IndexedDbStore.accessModes.READ).objectStore(this._configuration.name).count();t.onsuccess=()=>{e(t.result)}}catch(e){t(e)}})}}indexed_db_store_IndexedDbStore.errMsgs={NO_DB:"Store is not associated with a DB",NO_STORE_NAME:"A store name is missing from a configuration",NO_PRIMARY_INDEX:"A primaryIndex tree is missing from a configuration",NO_PRIMARY_INDEX_PROPS:'A primaryIndex tree must have either a "keyPath" or "auto" props',NO_KEYS_PROVIDED:"No keys are provided",MISSING_SECONDARY_INDEX:"Specified secondary index does not exist",DUPLICATE_RECORD:"Record already exists"};class cedict_permanent_storage_CedictPermanentStorage extends Storage{constructor(e){super(e),this._configuration=e,this._db=null,this._stores=new Map,this.metaKey=1,Object.values(this._configuration.stores).forEach(e=>{this._stores.set(e.name,new indexed_db_store_IndexedDbStore(e))})}static _checkConfiguration(e){if(!e.name)throw new Error(cedict_permanent_storage_CedictPermanentStorage.errMsgs.NO_STORAGE_NAME);if(!e.version)throw new Error(cedict_permanent_storage_CedictPermanentStorage.errMsgs.NO_STORAGE_VERSION);if(!e.stores)throw new Error(cedict_permanent_storage_CedictPermanentStorage.errMsgs.NO_STORES)}_assertConnection(){if(!this._db)throw new Error(cedict_permanent_storage_CedictPermanentStorage.errMsgs.CLOSED_CONNECTION)}hasStore(e){return this._stores.has(e)}getStore(e){if(!this._stores.has(e))throw new Error(cedict_permanent_storage_CedictPermanentStorage.errMsgs.MISSING_STORE);return this._assertConnection(),this._stores.get(e)}getIntegrityData(){let e;this._assertConnection();try{e=[this._stores.get("meta"),this._stores.get("dictionary")].map(e=>e.count()),e.push(this._stores.get("meta").get(this.metaKey))}catch(e){return Promise.reject(e)}return Promise.all(e).then(([e,t,r])=>{if(!r||0===r.length)throw new Error(cedict_permanent_storage_CedictPermanentStorage.errMsgs.NO_META);return{recordsInMeta:e,recordsInDictionary:t,metadata:r[0]}})}connect(){return new Promise((e,t)=>{let r;try{r=indexedDB.open(this._configuration.name,this._configuration.version)}catch(e){t(e)}r.onupgradeneeded=this._create.bind(this,r),r.onblocked=()=>t(new Error(cedict_permanent_storage_CedictPermanentStorage.errMsgs.BLOCKED_ON_OPEN)),r.onsuccess=()=>{this._db=r.result,this._db.onversionchange=this._versionchangeHandler.bind(this,t),this._stores.forEach(e=>e.associateWith(this._db)),e()},r.onerror=e=>{t(e)}})}disconnect(){return this._db&&(this._stores.forEach(e=>e.dissociate()),this._db.close(),this._db=null),Promise.resolve()}clear(){return this._assertConnection(),Promise.all(Array.from(this._stores.values()).map(e=>e.clear()))}_create(e,t){this._db=e.result;const r=Array.from(this._stores.values()).map(e=>e.associateWith(this._db).create());return Promise.all(r)}destroy(){return new Promise((e,t)=>{this._assertConnection(),this.disconnect().then(()=>{const r=indexedDB.deleteDatabase(this._configuration.name);r.onsuccess=()=>{e()},r.onerror=()=>{t(new Error(cedict_permanent_storage_CedictPermanentStorage.errMsgs.DESTRUCTION_ERROR))}})})}async _versionchangeHandler(e){await this.disconnect(),console.error(cedict_permanent_storage_CedictPermanentStorage.errMsgs.VERSION_CHANGE),e(new Error(cedict_permanent_storage_CedictPermanentStorage.errMsgs.VERSION_CHANGE))}}cedict_permanent_storage_CedictPermanentStorage.errMsgs={NO_STORAGE_NAME:"Storage name is missing from a configuration",NO_STORAGE_VERSION:"Storage version is missing from a configuration",NO_STORES:"No stores are defined in a configuration",NO_META:"Metadata store has no records",DESTRUCTION_ERROR:"Unable to destroy a storage",MISSING_STORE:"The store requested does not exist",CLOSED_CONNECTION:"Connection to the store is closed",BLOCKED_ON_OPEN:"Request to open a database has been blocked",VERSION_CHANGE:"A database change has occurred. You should refresh this browser window or close it down."};class cedict_Cedict{constructor(e){cedict_Cedict.checkConfiguration(e),this._configuration=e,this.isReady=!1,this._storage=new cedict_permanent_storage_CedictPermanentStorage(this._configuration.storage),this.cedict={meta:{},metaKey:1,dictionary:null,traditionalHeadwordsIdx:null,simplifiedHeadwordsIdx:null},this.preferredCharacterForm=i.TRADITIONAL,this.fallbackCharacterForm=i.SIMPLIFIED}static checkConfiguration(e){if(!e.storage)throw new Error(cedict_Cedict.errMsgs.CONF_NO_STORAGE);if(!e.storage.stores)throw new Error(cedict_Cedict.errMsgs.CONF_NO_STORES);if(!e.storage.stores.dictionary)throw new Error(cedict_Cedict.errMsgs.CONF_NO_DICT);if(!e.storage.stores.dictionary.primaryIndex)throw new Error(cedict_Cedict.errMsgs.CONF_NO_DICT_PRIMARY_IDX);if(!e.storage.stores.dictionary.primaryIndex.hasOwnProperty("keyPath"))throw new Error(cedict_Cedict.errMsgs.CONF_NO_DICT_PRIMARY_IDX_KEY_PATH);if(!e.storage.stores.dictionary.volatileStorage)throw new Error(cedict_Cedict.errMsgs.CONF_NO_DICT_VOLATILE);if(!e.storage.stores.dictionary.volatileStorage.hasOwnProperty("enabled"))throw new Error(cedict_Cedict.errMsgs.CONF_NO_DICT_VOLATILE_ENABLED);if(!e.storage.stores.dictionary.volatileStorage.hasOwnProperty("indexed"))throw new Error(cedict_Cedict.errMsgs.CONF_NO_DICT_VOLATILE_INDEXED);if(!e.storage.stores.dictionary.permanentStorage)throw new Error(cedict_Cedict.errMsgs.CONF_NO_DICT_PERM);if(!e.storage.stores.dictionary.permanentStorage.hasOwnProperty("enabled"))throw new Error(cedict_Cedict.errMsgs.CONF_NO_DICT_PERM_ENABLED);if(!e.storage.stores.dictionary.permanentStorage.hasOwnProperty("indexed"))throw new Error(cedict_Cedict.errMsgs.CONF_NO_DICT_PERM_INDEXED);if(!e.data)throw new Error(cedict_Cedict.errMsgs.CONF_NO_DATA);if(!e.data.version)throw new Error(cedict_Cedict.errMsgs.CONF_NO_DATA_VER);if(!e.data.revision)throw new Error(cedict_Cedict.errMsgs.CONF_NO_DATA_REV);if(!e.data.recordsCount)throw new Error(cedict_Cedict.errMsgs.CONF_NO_DATA_REC_COUNT);if(!e.data.URI)throw new Error(cedict_Cedict.errMsgs.CONF_NO_DATA_URI);if(!e.data.chunks||0===e.data.chunks.length)throw new Error(cedict_Cedict.errMsgs.CONF_NO_DATA_CHUNKS)}async init(){let e=!0;try{await this._storage.connect()}catch(t){if(t.name!==cedict_Cedict.errNames.SECURITY_ERR)throw t;e=!1,console.warn("LexisCS will disable IndexedDB because it is not supported in the current environment")}return e?this._initWithIndexedDb():this._initWithoutIndexedDb()}async hasDataLoaded(){let e;try{await this._storage.connect();const t=await this._storage.getIntegrityData();e=this.isStorageIntact(t)}catch(t){e=!1}finally{await this._storage.disconnect()}return e}_initWithIndexedDb(){return new Promise((e,t)=>this._storage.getIntegrityData().then(e=>{if(!this.isStorageIntact(e))throw new Error("Storage is outdated");if(this._configuration.storage.stores.dictionary.volatileStorage.enabled)return this._storage.getStore("dictionary").getAllEntries().then(t=>this._populateVolatileStorage(e.metadata,t)).catch(e=>t(e))}).catch(()=>this.removePermanentData().then(()=>this._storage.connect()).then(()=>this._downloadData()).then(({meta:e,dictionary:t})=>(this._configuration.storage.stores.dictionary.volatileStorage.enabled&&this._populateVolatileStorage(e,t),this._populatePermanentStorage(e,t).then(()=>Promise.resolve()).catch(r=>(console.error("Unable to store CEDICT data to IndexedDB.",r),this._configuration.storage.stores.dictionary.volatileStorage.enabled||(console.warn("Switched to in-memory placement of CEDICT data"),this._configuration.storage.stores.dictionary.volatileStorage.enabled=!0,this._populateVolatileStorage(e,t)),Promise.resolve()))))).then(()=>{this.isReady=!0,e()}).catch(e=>{t(e)}))}async _initWithoutIndexedDb(){const{meta:e,dictionary:t}=await this._downloadData();this._configuration.storage.stores.dictionary.permanentStorage.enabled=!1,this._configuration.storage.stores.dictionary.volatileStorage.enabled=!0,this._configuration.storage.stores.dictionary.volatileStorage.indexed=!0,await this._populateVolatileStorage(e,t),this.isReady=!0}removePermanentData(){return this._storage.destroy()}static isSupportedCharacterForm(e){return Array.from(Object.values(i)).includes(e)}isStorageIntact(e){return 1===e.recordsInMeta&&e.recordsInDictionary===this._configuration.data.recordsCount&&e.metadata.version===this._configuration.data.version&&e.metadata.revision===this._configuration.data.revision}getWords(e,t){if(!this.isReady)return Promise.reject(new Error(cedict_Cedict.errMsgs.NOT_READY));let r=!0;if(void 0!==t){if(!cedict_Cedict.isSupportedCharacterForm(t))return Promise.reject(new Error(`${cedict_Cedict.errMsgs.BAD_CHAR_FORM} "${t}"`));r=!1}if(!e)return Promise.resolve({});const s=this._configuration.storage.stores.dictionary.volatileStorage.enabled?this._getWordsFromVolatileStorage.bind(this):this._getWordsFromPermanentStorage.bind(this);return new Promise((i,n)=>{r?s(e,this.preferredCharacterForm).then(t=>{if(!(cedict_Cedict._getResultRecordsCount(t)>0))return s(e,this.fallbackCharacterForm);i({[this.preferredCharacterForm]:t})}).then(e=>{const t=cedict_Cedict._getResultRecordsCount(e)>0?{[this.fallbackCharacterForm]:e}:{};i(t)}).catch(e=>n(e)):s(e,t).then(e=>{const r=cedict_Cedict._getResultRecordsCount(e)>0?{[t]:e}:{};i(r)}).catch(e=>n(e))})}_getWordsFromVolatileStorage(e,t){return new Promise((r,s)=>{try{Array.isArray(e)||(e=[e]);let s=e.reduce((e,t)=>(e[t]=[],e),{});this._configuration.storage.stores.dictionary.volatileStorage.indexed?e.forEach(e=>{const r=t===i.SIMPLIFIED?this.cedict.simplifiedHeadwordsIdx.get(e):this.cedict.traditionalHeadwordsIdx.get(e);s[e]=r?r.map(e=>this.cedict.dictionary.get(e)):[]}):this.cedict.dictionary.forEach(r=>{const n=t===i.SIMPLIFIED?r.simplified.headword:r.traditional.headword;e.forEach(e=>{n===e&&s[e].push(r)})}),r(s)}catch(e){s(e)}})}_getWordsFromPermanentStorage(e,t){const r=t===i.SIMPLIFIED?"simplifiedHwIdx":"traditionalHwIdx";return this._storage.getStore("dictionary").getEntries(e,{index:r})}_downloadData(){const e=this._configuration.data.chunks.map(e=>this._loadJson(`${this._configuration.data.URI}/${e}`));return Promise.all(e).then(e=>{let t=e[0].metadata;return t.cedict=e[0].cedictMeta,delete t.chunkNumber,{meta:t,dictionary:e.map(e=>e.entries).flat()}})}_populateVolatileStorage(e,t){this.cedict.meta=e,this._configuration.storage.stores.dictionary.volatileStorage.indexed?(this.cedict.dictionary=new Map,t.forEach(e=>this.cedict.dictionary.set(e[this._configuration.storage.stores.dictionary.primaryIndex.keyPath],e)),this._indexVolatileStorage()):this.cedict.dictionary=t}_indexVolatileStorage(){this.cedict.traditionalHeadwordsIdx=new Map,this.cedict.simplifiedHeadwordsIdx=new Map,this.cedict.dictionary.forEach(e=>{this.cedict.traditionalHeadwordsIdx.has(e.traditional.headword)?this.cedict.traditionalHeadwordsIdx.get(e.traditional.headword).push(e.index):this.cedict.traditionalHeadwordsIdx.set(e.traditional.headword,[e.index]),this.cedict.simplifiedHeadwordsIdx.has(e.simplified.headword)?this.cedict.simplifiedHeadwordsIdx.get(e.simplified.headword).push(e.index):this.cedict.simplifiedHeadwordsIdx.set(e.simplified.headword,[e.index])})}async _populatePermanentStorage(e,t){await this._storage.getStore("meta").update([e,this.cedict.metaKey]),await this._storage.getStore("dictionary").insert(t)}_loadJson(e){return fetch(e).then(e=>e.json())}static _getResultRecordsCount(e){return Object.values(e).flat().length}}cedict_Cedict.errMsgs={CONF_NO_STORAGE:"Storage tree is missing from a configuration",CONF_NO_STORES:"Stores data is missing from a configuration",CONF_NO_DICT:"Dictionary tree is missing from a configuration",CONF_NO_DICT_PRIMARY_IDX:"A primaryIndex tree of a dictionary is missing from a configuration",CONF_NO_DICT_PRIMARY_IDX_KEY_PATH:"A keyPath option of a primaryIndex tree of a dictionary is missing from a configuration",CONF_NO_DICT_VOLATILE:"A volatileStorage tree of a dictionary is missing from a configuration",CONF_NO_DICT_VOLATILE_ENABLED:"enabled option of a volatileStorage tree of a dictionary is missing from a configuration",CONF_NO_DICT_VOLATILE_INDEXED:"indexed option of a volatileStorage tree of a dictionary is missing from a configuration",CONF_NO_DICT_PERM:"A permanentStorage tree of a dictionary is missing from a configuration",CONF_NO_DICT_PERM_ENABLED:"enabled option of a permanentStorage tree of a dictionary is missing from a configuration",CONF_NO_DICT_PERM_INDEXED:"indexed option of a permanentStorage tree of a dictionary is missing from a configuration",CONF_NO_DATA:"Date tree is missing from a configuration",CONF_NO_DATA_VER:"Data version is missing from a configuration",CONF_NO_DATA_REV:"Data revision is missing from a configuration",CONF_NO_DATA_REC_COUNT:"Data records count is missing from a configuration",CONF_NO_DATA_URI:"Data URI is missing from a configuration",CONF_NO_DATA_CHUNKS:"Data chunks are missing from a configuration",NOT_READY:"CEDICT data is not ready",BAD_CHAR_FORM:"Unknown character form"},cedict_Cedict.errNames={SECURITY_ERR:"SecurityError"};var n={storage:{name:"cedict",version:1,stores:{meta:{name:"meta",primaryIndex:{auto:!0}},dictionary:{name:"dictionary",primaryIndex:{keyPath:"index"},indexes:{traditional:{name:"traditionalHwIdx",keyPath:"traditional.headword",unique:!1},simplified:{name:"simplifiedHwIdx",keyPath:"simplified.headword",unique:!1}},volatileStorage:{enabled:!1,indexed:!1},permanentStorage:{enabled:!0,indexed:!0}}}},data:{version:20191029,revision:1,recordsCount:117735,URI:"https://lexis-dev.alpheios.net/cedict",chunks:["cedict-v20191029-c001.json","cedict-v20191029-c002.json","cedict-v20191029-c003.json","cedict-v20191029-c004.json","cedict-v20191029-c005.json"]}};let o;const messageHandler=async(e,t)=>{if(e.body.loadData)if(o.isReady)t(s.ResponseMessage.Success(e,{}));else try{await o.init(),console.log("CEDICT service is ready"),t(s.ResponseMessage.Success(e,{}))}catch(r){console.error("Cannot initialize a CEDICT service: "+r.message),t(s.ResponseMessage.Error(e,new Error("Initialization error"),s.ResponseMessage.errorCodes.INITIALIZATION_ERROR))}else if(e.body.getWords){if(!o.isReady)try{await o.hasDataLoaded()&&await o.init()}catch(e){}if(!o.isReady)return void t(s.ResponseMessage.Error(e,new Error("Uninitialized"),s.ResponseMessage.errorCodes.SERVICE_UNINITIALIZED));o.getWords(e.body.getWords.words,e.body.getWords.characterForm).then(r=>{t(s.ResponseMessage.Success(e,r))}).catch(r=>t(s.ResponseMessage.Error(e,r,s.ResponseMessage.errorCodes.INTERNAL_ERROR)))}else t(s.ResponseMessage.Error(e,new Error("Unsupported request"),s.ResponseMessage.errorCodes.UNKNOWN_REQUEST))};document.addEventListener("DOMContentLoaded",()=>{new s.MessagingService("CedictRequestListener",new s.WindowIframeDestination({...s.CedictDestinationConfig,commModes:[s.WindowIframeDestination.commModes.RECEIVE],receiverCB:messageHandler}));try{o=new cedict_Cedict(n)}catch(e){console.error(e)}})}])}));